import{f as L,a as M,c as Ne}from"../chunks/DCubpxHF.js";import{i as Me}from"../chunks/yIDQwdGA.js";import{o as Fe}from"../chunks/BHIs7hwi.js";import{c as ne,h as H,R as Oe,l as le,a as Re,b as He,C as u,as as Le,r as ze,H as Pe,s as ge,d as se,n as q,Z as Ue,aq as Ve,a9 as me,i as P,m as ue,t as Je,ao as de,at as We,a0 as _e,au as U,av as qe,aw as Be,ax as Ye,ay as O,j as Ie,p as ke,az as ie,_ as $e,an as Ke,k as Qe,aA as Xe,aB as Ze,y as Ge,a1 as je,aC as ea,I as aa,K as B,M as ta,Q as C,aD as h,O as I,P as E,aE as we,J as ra}from"../chunks/B8bJjLrw.js";import{e as Y,s as $}from"../chunks/ZGXG3O0-.js";import{i as K}from"../chunks/46vft45f.js";import{r as be}from"../chunks/CJRWyrcJ.js";function na(e,a,s){for(var o=[],v=a.length,t,i=a.length,r=0;r<v;r++){let c=a[r];ke(c,()=>{if(t){if(t.pending.delete(c),t.done.add(c),t.pending.size===0){var g=e.outrogroups;ve(de(t.done)),g.delete(t),g.size===0&&(e.outrogroups=null)}}else i-=1},!1)}if(i===0){var d=o.length===0&&s!==null;if(d){var l=s,p=l.parentNode;Ke(p),p.append(l),e.items.clear()}ve(a,!d)}else t={pending:new Set(a),done:new Set},(e.outrogroups??=new Set).add(t)}function ve(e,a=!0){for(var s=0;s<e.length;s++)Qe(e[s],a)}var Ee;function la(e,a,s,o,v,t=null){var i=e,r=new Map;{var d=e;i=H?ne(Oe(d)):d.appendChild(le())}H&&Re();var l=null,p=Le(()=>{var m=s();return We(m)?m:m==null?[]:de(m)}),c,g=!0;function N(){w.fallback=l,sa(w,c,i,a,o),l!==null&&(c.length===0?(l.f&O)===0?Ie(l):(l.f^=O,W(l,null,i)):ke(l,()=>{l=null}))}var n=He(()=>{c=u(p);var m=c.length;let k=!1;if(H){var b=ze(i)===Pe;b!==(m===0)&&(i=ge(),ne(i),se(!1),k=!0)}for(var A=new Set,D=P,T=Je(),x=0;x<m;x+=1){H&&q.nodeType===Ue&&q.data===Ve&&(i=q,k=!0,se(!1));var R=c[x],y=o(R,x),S=g?null:r.get(y);S?(S.v&&me(S.v,R),S.i&&me(S.i,x),T&&D.skipped_effects.delete(S.e)):(S=ia(r,g?i:Ee??=le(),R,y,x,v,a,s),g||(S.e.f|=O),r.set(y,S)),A.add(y)}if(m===0&&t&&!l&&(g?l=ue(()=>t(i)):(l=ue(()=>t(Ee??=le())),l.f|=O)),H&&m>0&&ne(ge()),!g)if(T){for(const[X,Z]of r)A.has(X)||D.skipped_effects.add(Z.e);D.oncommit(N),D.ondiscard(()=>{})}else N();k&&se(!0),u(p)}),w={effect:n,items:r,outrogroups:null,fallback:l};g=!1,H&&(i=q)}function sa(e,a,s,o,v){var t=a.length,i=e.items,r=e.effect.first,d,l=null,p=[],c=[],g,N,n,w;for(w=0;w<t;w+=1){if(g=a[w],N=v(g,w),n=i.get(N).e,e.outrogroups!==null)for(const y of e.outrogroups)y.pending.delete(n),y.done.delete(n);if((n.f&O)!==0)if(n.f^=O,n===r)W(n,null,s);else{var m=l?l.next:r;n===e.effect.last&&(e.effect.last=n.prev),n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),F(e,l,n),F(e,n,m),W(n,m,s),l=n,p=[],c=[],r=l.next;continue}if((n.f&ie)!==0&&Ie(n),n!==r){if(d!==void 0&&d.has(n)){if(p.length<c.length){var k=c[0],b;l=k.prev;var A=p[0],D=p[p.length-1];for(b=0;b<p.length;b+=1)W(p[b],k,s);for(b=0;b<c.length;b+=1)d.delete(c[b]);F(e,A.prev,D.next),F(e,l,A),F(e,D,k),r=k,l=D,w-=1,p=[],c=[]}else d.delete(n),W(n,r,s),F(e,n.prev,n.next),F(e,n,l===null?e.effect.first:l.next),F(e,l,n),l=n;continue}for(p=[],c=[];r!==null&&r!==n;)(d??=new Set).add(r),c.push(r),r=r.next;if(r===null)continue}(n.f&O)===0&&p.push(n),l=n,r=n.next}if(e.outrogroups!==null){for(const y of e.outrogroups)y.pending.size===0&&(ve(de(y.done)),e.outrogroups?.delete(y));e.outrogroups.size===0&&(e.outrogroups=null)}if(r!==null||d!==void 0){var T=[];if(d!==void 0)for(n of d)(n.f&ie)===0&&T.push(n);for(;r!==null;)(r.f&ie)===0&&r!==e.fallback&&T.push(r),r=r.next;var x=T.length;if(x>0){var R=t===0?s:null;na(e,T,R)}}}function ia(e,a,s,o,v,t,i,r){var d=(i&Be)!==0?(i&Ye)===0?U(s,!1,!1):_e(s):null,l=(i&qe)!==0?_e(v):null;return{v:d,i:l,e:ue(()=>(t(a,d??s,l??v,r),()=>{e.delete(o)}))}}function W(e,a,s){if(e.nodes)for(var o=e.nodes.start,v=e.nodes.end,t=a&&(a.f&O)===0?a.nodes.start:s;o!==null;){var i=$e(o);if(t.before(o),o===v)return;o=i}}function F(e,a,s){a===null?e.effect.first=s:a.next=s,s===null?e.effect.last=a:s.prev=a}function ye(e,a,s=a){var o=new WeakSet;Xe(e,"input",async v=>{var t=v?e.defaultValue:e.value;if(t=oe(e)?fe(t):t,s(t),P!==null&&o.add(P),await Ze(),t!==(t=a())){var i=e.selectionStart,r=e.selectionEnd,d=e.value.length;if(e.value=t??"",r!==null){var l=e.value.length;i===r&&r===d&&l>d?(e.selectionStart=l,e.selectionEnd=l):(e.selectionStart=i,e.selectionEnd=Math.min(r,l))}}}),(H&&e.defaultValue!==e.value||Ge(a)==null&&e.value)&&(s(oe(e)?fe(e.value):e.value),P!==null&&o.add(P)),je(()=>{var v=a();if(e===document.activeElement){var t=ea??P;if(o.has(t))return}oe(e)&&v===fe(e.value)||e.type==="date"&&!v&&!e.value||v!==e.value&&(e.value=v??"")})}function oe(e){var a=e.type;return a==="number"||a==="range"}function fe(e){return e===""?null:+e}function oa(e){return function(...a){var s=a[0];return s.preventDefault(),e?.apply(this,a)}}const Q="http://localhost:3000";async function fa(){const e=await fetch(`${Q}/items`);if(!e.ok)throw new Error("Failed to fetch items");return e.json()}async function ua(e){const a=await fetch(`${Q}/items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw new Error("Failed to create item");return a.json()}async function va(e,a){const s=await fetch(`${Q}/items/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw new Error("Failed to update item");return s.json()}async function da(e){if(!(await fetch(`${Q}/items/${e}`,{method:"DELETE"})).ok)throw new Error("Failed to delete item")}var ca=L('<div class="error svelte-1uha8ag"> </div>'),ha=L('<button type="button" class="svelte-1uha8ag">Cancel</button>'),pa=L("<p>Loading...</p>"),ga=L("<p>No items yet. Create one above!</p>"),ma=L('<li class="svelte-1uha8ag"><div class="item-content svelte-1uha8ag"><strong> </strong> <span class="svelte-1uha8ag"> </span></div> <div class="item-actions svelte-1uha8ag"><button class="svelte-1uha8ag">Edit</button> <button class="delete svelte-1uha8ag">Delete</button></div></li>'),_a=L('<ul class="svelte-1uha8ag"></ul>'),wa=L('<div class="container svelte-1uha8ag"><h1 class="svelte-1uha8ag">Items Manager</h1> <!> <form class="form svelte-1uha8ag"><div class="form-group svelte-1uha8ag"><label for="what" class="svelte-1uha8ag">What:</label> <input id="what" type="text" placeholder="Enter description" class="svelte-1uha8ag"/></div> <div class="form-group svelte-1uha8ag"><label for="when" class="svelte-1uha8ag">When:</label> <input id="when" type="date" class="svelte-1uha8ag"/></div> <div class="button-group svelte-1uha8ag"><button type="submit" class="svelte-1uha8ag"> </button> <!></div></form> <div class="items-list svelte-1uha8ag"><h2 class="svelte-1uha8ag">Items</h2> <!></div></div>');function Ca(e,a){aa(a,!1);let s=U([]),o=U(!1),v=U(""),t=U({what:"",when:""}),i=U(null);Fe(async()=>{await r()});async function r(){h(o,!0),h(v,"");try{h(s,await fa())}catch(f){h(v,f instanceof Error?f.message:"Failed to load items")}finally{h(o,!1)}}async function d(){if(!u(t).what||!u(t).when){h(v,"Please fill in all fields");return}h(o,!0),h(v,"");try{u(i)!==null?(await va(u(i),u(t)),h(i,null)):await ua(u(t)),h(t,{what:"",when:""}),await r()}catch(f){h(v,f instanceof Error?f.message:"Operation failed")}finally{h(o,!1)}}function l(f){f.id!==void 0&&(h(i,f.id),h(t,{what:f.what,when:f.when}))}function p(){h(i,null),h(t,{what:"",when:""})}async function c(f){if(confirm("Are you sure you want to delete this item?")){h(o,!0),h(v,"");try{await da(f),await r()}catch(_){h(v,_ instanceof Error?_.message:"Failed to delete item")}finally{h(o,!1)}}}Me();var g=wa(),N=C(I(g),2);{var n=f=>{var _=ca(),G=I(_,!0);E(_),B(()=>$(G,u(v))),M(f,_)};K(N,f=>{u(v)&&f(n)})}var w=C(N,2),m=I(w),k=C(I(m),2);be(k),E(m);var b=C(m,2),A=C(I(b),2);be(A),E(b);var D=C(b,2),T=I(D),x=I(T,!0);E(T);var R=C(T,2);{var y=f=>{var _=ha();B(()=>_.disabled=u(o)),Y("click",_,p),M(f,_)};K(R,f=>{u(i)!==null&&f(y)})}E(D),E(w);var S=C(w,2),X=C(I(S),2);{var Z=f=>{var _=pa();M(f,_)},Te=f=>{var _=Ne(),G=ra(_);{var Se=z=>{var V=ga();M(z,V)},Ce=z=>{var V=_a();la(V,5,()=>u(s),j=>j.id,(j,J)=>{var ee=ma(),ae=I(ee),te=I(ae),De=I(te,!0);E(te);var ce=C(te,2),xe=I(ce,!0);E(ce),E(ae);var he=C(ae,2),re=I(he),pe=C(re,2);E(he),E(ee),B(Ae=>{$(De,u(J).what),$(xe,Ae),re.disabled=u(o),pe.disabled=u(o)},[()=>new Date(u(J).when).toLocaleDateString()]),Y("click",re,()=>l(u(J))),Y("click",pe,()=>u(J).id&&c(u(J).id)),M(j,ee)}),E(V),M(z,V)};K(G,z=>{u(s).length===0?z(Se):z(Ce,!1)},!0)}M(f,_)};K(X,f=>{u(o)&&u(s).length===0?f(Z):f(Te,!1)})}E(S),E(g),B(()=>{k.disabled=u(o),A.disabled=u(o),T.disabled=u(o),$(x,u(i)!==null?"Update":"Create")}),ye(k,()=>u(t).what,f=>we(t,u(t).what=f)),ye(A,()=>u(t).when,f=>we(t,u(t).when=f)),Y("submit",w,oa(d)),M(e,g),ta()}export{Ca as component};
